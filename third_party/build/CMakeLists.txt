set(THIRDPARTY_SUBDIRECTORIES "")

if(WITH_RESAMPLE_LIBRESAMPLE)
    set(THIRDPARTY_SUBDIRECTORIES ${THIRDPARTY_SUBDIRECTORIES} resample)
endif()

if(WITH_SRTP)
    set(THIRDPARTY_SUBDIRECTORIES ${THIRDPARTY_SUBDIRECTORIES} srtp)
endif()

if(WITH_CODEC_GSM)
    set(THIRDPARTY_SUBDIRECTORIES ${THIRDPARTY_SUBDIRECTORIES} gsm)
endif()

if(WITH_CODEC_SPEEX)
    set(THIRDPARTY_SUBDIRECTORIES ${THIRDPARTY_SUBDIRECTORIES} speex)
endif()

if(WITH_CODEC_ILBC)
    set(THIRDPARTY_SUBDIRECTORIES ${THIRDPARTY_SUBDIRECTORIES} ilbc)
endif()

if(WITH_CODEC_G722 OR WITH_CODEC_G7221)
    set(THIRDPARTY_SUBDIRECTORIES ${THIRDPARTY_SUBDIRECTORIES} g7221)
endif()

if(WITH_CODEC_OPUS)
    set(THIRDPARTY_SUBDIRECTORIES ${THIRDPARTY_SUBDIRECTORIES} opus)
endif()

if(WITH_AUDIODEV_PORTAUDIO)
    set(THIRDPARTY_SUBDIRECTORIES ${THIRDPARTY_SUBDIRECTORIES} portaudio)
endif()

if(WITH_UUID_LIB)
    set(THIRDPARTY_SUBDIRECTORIES ${THIRDPARTY_SUBDIRECTORIES} uuid)
endif()

set(THIRDPARTY_OBJECTS_LIST)
foreach(SUBDIR ${THIRDPARTY_SUBDIRECTORIES})
    add_subdirectory(${SUBDIR})
    if (TARGET ${SUBDIR})
        get_target_property(target_type ${SUBDIR} TYPE)
        if (target_type STREQUAL "STATIC_LIBRARY")
            set(THIRDPARTY_OBJECTS_LIST ${THIRDPARTY_OBJECTS_LIST} ${SUBDIR})
        else()
            set(THIRDPARTY_OBJECTS_LIST ${THIRDPARTY_OBJECTS_LIST}
                $<TARGET_OBJECTS:${SUBDIR}>
            )
        endif ()
    endif()
endforeach()

set(THIRDPARTY_OBJECTS_LIST ${THIRDPARTY_OBJECTS_LIST} PARENT_SCOPE)
